<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Я - как проект</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Load c3.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.css"
          integrity="sha512-cznfNokevSG7QPA5dZepud8taylLdvgr0lDqw/FEZIhluFsSwyvS81CMnRdrNSKwbsmc43LtRd2/WMQV+Z85AQ=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <!-- Load d3.js and c3.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
            integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.js"
            integrity="sha512-+IpCthlNahOuERYUSnKFjzjdKXIbJ/7Dd6xvUp+7bEw0Jp2dg6tluyxLs+zq9BMzZgrLv8886T4cBSqnKiVgUw=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>


<div class="container">
    <nav aria-label="breadcrumb" class="mt-3">
  <ol class="breadcrumb">
    <li class="breadcrumb-item fs-5"><a href="{% url 'documents' %}">Главная страница</a></li>
    <li class="breadcrumb-item fs-5 active" aria-current="page">История</li>
  </ol>
</nav>
    <div class="mt-5">

    <div class="accordion" id="accordionExample">
        {% for event in events %}
            <div class="accordion-item">
            <h2 class="accordion-header" id="accordion{{event.pk}}">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapse{{event.pk}}"
                        aria-expanded="true" aria-controls="collapseOne">
                    {{event.title}}
                </button>
            </h2>
            <div id="collapse{{event.pk}}" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                 data-bs-parent="accordion{{event.pk}}">
                <div class="accordion-body">

                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Название</th>
                                <th scope="col">
                                    <div class="d-flex">
                                        <span>Рейтинг по статусу</span>
                                    </div>

                                </th>
                                <th scope="col">

                                    <div class="d-flex">
                                        <span>Рейтинг по дедлайну</span>
                                    </div>

                                </th>
                                <th scope="col">

                                    <div class="d-flex">
                                        <span>Рейтинг по составленному плану</span>
                                    </div>
                                </th>
                                <th scope="col"></th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for d in event.document_set.all %}
                            <tr>
                                <th scope="row">{{ forloop.counter }}</th>
                                <td><a href="{% url 'document' d.pk %}" style="text-decoration:None">{{ d.title }}</a>
                                </td>
                                <td>{{ d.status_ratio }}</td>
                                <td>{{ d.deadline_ratio }}</td>
                                <td>{{ d.action_plan_ratio }}</td>
                                <td>
                                    {# Скачать файл #}
                                    <a title="Скачать" style="padding-right: 2px; text-decoration:None"
                                       href="{% url 'download' d.pk %}">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                             fill="currentColor"
                                             class="bi bi-arrow-down-circle" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd"
                                                  d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V4.5z"/>
                                        </svg>
                                    </a>

                                    <div class="modal fade" id="myModal{{ d.pk }}">
                                        <div class="modal-dialog">
                                            <div class="modal-content">

                                                <!-- Modal Header -->
                                                <div class="modal-header">
                                                    <h4 class="modal-title">Обновление файла</h4>
                                                    <button type="button" class="btn-close"
                                                            data-bs-dismiss="modal"></button>
                                                </div>

                                                <!-- Modal body -->
                                                <div class="modal-body d-flex">
                                                    <form class="d-flex" action="{% url 'update' d.pk %}" method="post"
                                                          enctype="multipart/form-data">
                                                        {% csrf_token %}
                                                        <div>


                                                            {{ formDocUpdate.as_p }}
                                                        </div>

                                                        <div>
                                                            <input type="submit" value="Загрузить"
                                                                   class="btn btn-success">
                                                        </div>


                                                    </form>
                                                </div>

                                                <!-- Modal footer -->
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-danger"
                                                            data-bs-dismiss="modal">Закрыть
                                                    </button>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                    {# Удалить файл ( для админа ) #}
                                    {% if request.user.is_staff %}
                                    <a title="Удалить файл" href="{% url 'delete' d.pk %}" style="text-decoration:None">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                             fill="currentColor"
                                             class="bi bi-basket3" viewBox="0 0 16 16">
                                            <path d="M5.757 1.071a.5.5 0 0 1 .172.686L3.383 6h9.234L10.07 1.757a.5.5 0 1 1 .858-.514L13.783 6H15.5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H.5a.5.5 0 0 1-.5-.5v-1A.5.5 0 0 1 .5 6h1.717L5.07 1.243a.5.5 0 0 1 .686-.172zM3.394 15l-1.48-6h-.97l1.525 6.426a.75.75 0 0 0 .729.574h9.606a.75.75 0 0 0 .73-.574L15.056 9h-.972l-1.479 6h-9.21z"/>
                                        </svg>
                                    </a>
                                    {% endif %}
                                </td>


                            </tr>

                            {%endfor%}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

</div>
</div>
</body>
</html>






